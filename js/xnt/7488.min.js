var t=1297110663,v=70,data=d3.range(58).map(next);var w=20,h=600;var x=d3.scale.linear().domain([0,1]).range([0,w]);var y=d3.scale.linear().domain([0,100]).rangeRound([0,h]);var chart=d3.select("#d3chart").append("svg").attr("class","chart").attr("width",w*data.length-1).attr("height",h);chart.selectAll("rect").data(data).enter().append("rect").attr("x",function(b,a){return x(a)-0.5}).attr("y",function(a){return h-y(a.value)-0.5}).attr("width",w).attr("height",function(a){return y(a.value)});chart.append("line").attr("x1",0).attr("x2",w*data.length).attr("y1",h-0.5).attr("y2",h-0.5).style("stroke","#000");setInterval(function(){data.shift();data.push(next());redraw()},1500);function next(){return{time:++t,value:v=~~Math.max(10,Math.min(90,v+10*(Math.random()-0.5)))}}function redraw(){var a=chart.selectAll("rect").data(data,function(b){return b.time});a.enter().insert("rect","line").attr("x",function(c,b){return x(b+1)-0.5}).attr("y",function(b){return h-y(b.value)-0.5}).attr("width",w).attr("height",function(b){return y(b.value)}).transition().duration(1000).attr("x",function(c,b){return x(b)-0.5});a.transition().duration(1000).attr("x",function(c,b){return x(b)-0.5});a.exit().transition().duration(1000).attr("x",function(c,b){return x(b-1)-0.5}).remove()};